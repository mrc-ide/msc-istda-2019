---
title: "Session 3: Data visualisation"
author: Dr Juliette Unwin
date: 23rd October 2019
output: 
  revealjs::revealjs_presentation:
    css: ../styles.css
    center: true
    includes:
      in_header: ../header-footer.html
---

```{r include = FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(viridis)

library(knitr)
opts_knit$set(root.dir = '../')
```

***
Today's session will cover data visualisation using

* base R
* qplot
* ggplot

and is based on data visualisation chapter in R for Data Science by Gorlemund and Wickham.

***

What do you remember from last week? 

https://forms.gle/asekqiTJRPyHK7gB9

<img class="plain"  text-align:middle  src="../images/weekthree.png">

***
## Exploring the test data set

```{r echo = TRUE, collapse = TRUE}
library(tidyverse)
mpg

head(mpg)
```

***
## Plotting with base R

***
## Scatter plots

```{r echo = TRUE, collapse = TRUE, fig.align='center', fig.width=6, fig.height=4}
plot(mpg$displ, mpg$hwy)

# What else is needed to make this a good plot?
# Titles
plot(mpg$displ, mpg$hwy, xlab = "Engine displacement", ylab = "Highway miles per gallon", 
     main = "Car plot", cex.main=1.5, cex.lab=1.5)
# Grid lines
grid()

# Specifying shape of points - ?pch
plot(mpg$displ, mpg$hwy, xlab = "Engine displacement", ylab = "Highway miles per gallon", 
     main = "Car plot", cex.main=1.5, cex.lab=1.5, pch = 16)

# Specifying colour of points
plot(mpg$displ, mpg$hwy, col = "red")
plot(mpg$displ, mpg$hwy, col = mpg$cyl)
# Adding legend
legend(6, 45, legend = unique(mpg$cyl), col = c(4, 6, 8, 5), pch = 16)
```

***
## Line plots

```{r echo = TRUE, collapse = TRUE, fig.align='center', fig.width=6, fig.height=4}

x <- 1:10
y <- x^2 + 3*x - 6
plot(x, y, type = 'l')

# Adding a second line 
y2 <- - x^2 - 3*x + 52
plot(x, y, type = 'l')
lines(x, y2, col = "red")

# Line weight
plot(x, y, type = 'l', lwd=2)

# Line style
plot(x, y, type = 'l', lty=2)
```

***
## Line plots - line styles
* 0: blank, 
* 1: solid (default) 
* 2: dashed
* 3: dotted 
* 4: dotdash
* 5: longdash 
* 6: twodash.

***
## Scatter graph with trend lines
```{r echo = TRUE, collapse = TRUE, fig.align='center', fig.width=6, fig.height=4}
plot(mpg$displ, mpg$hwy)
abline(lm(mpg$hwy ~ mpg$displ))
```

***
## Bar graph

```{r echo = TRUE, collapse = TRUE, fig.align='center', fig.width=6, fig.height=4}
# Making a bar graph for the different numbers of cars from each manufacturer
count <- table(mpg$manufacturer)
barplot(count)

# Rotating axis names
barplot(count, las=2)

# Changing colours
barplot(count, col="blue")
```
## Plotting bar graphs side by side

```{r echo = TRUE, collapse = TRUE, fig.align='center', fig.width=6, fig.height=4}
table <- table(mpg$cyl, mpg$class, dnn=c("Cylinders", "Class")) # Creates a contingency table
table

# Stacked
barplot(table)

# Sidebyside
barplot(table, 
        col = c("turquoise4", "turquoise2", "turquoise", "turquoise3"),
        beside=TRUE)

legend("left", title="Cylinders", 
       legend = sort(unique(mpg$cyl)), 
       fill =c("turquoise4", "turquoise2", "turquoise", "turquoise3"),
       box.lty=0)
```

***
## Histograms
```{r echo = TRUE, collapse = TRUE, fig.align='center', fig.width=6, fig.height=4}
hist(mpg$displ)

# Normalising histogram
hist(mpg$displ, freq=FALSE)

# Changing size of bins
hist(mpg$displ, breaks = 20)

# Looking at information about histograms
hist_info <- hist(mpg$displ, breaks = 20)
hist_info
```

***
## Vertical and horizontal lines
```{r echo = TRUE, collapse = TRUE, fig.align='center', fig.width=6, fig.height=4}
plot(x = 1:10, y = x^2, type = 'l')
abline(v = 5)
abline(h = 60)
```

***
## Multiple plots

```{r echo = TRUE, collapse = TRUE, fig.align='center', fig.width=6, fig.height=4}
par(mfrow=c(1,2))
plot(x = 1:10, y = x^2, type = 'l')
plot(x = 1:10, y = x^3, type = 'l')
```

***
## Plotting with qplot (ggplot2)

This is what you did last week.
It's simple plotting with the package ggplot2.  
Can use, but no time to go over all the options now.

***
## Plotting with ggplot

*** 
## Summary

* Base r and qplot are generally thought to be easier to use.
* ggplot2 is more flexible and can make nicer plots visually.
* Which you use is up to you and sometimes one may be better than the other.